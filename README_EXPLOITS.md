# Exploit Test Suite

## Table of Contents
- [messages-sequential](exploit-tests/solidity/messages-sequential/Idea1.t.sol)
- [no-empty-payload-hash](exploit-tests/solidity/no-empty-payload-hash/Idea1.t.sol)
- [composer-assert-sender](exploit-tests/solidity/composer-assert-sender/Idea1.t.sol)
- [precrime-simulator-revert](exploit-tests/solidity/precrime-simulator-revert/Idea1.t.sol)


## Invariants

### messages-sequential
File: `packages/layerzero-v2/evm/protocol/contracts/MessagingChannel.sol:36` – messages can only be cleared sequentially.
- Idea1 Skip earlier nonce then clear later (High) ✅
- Idea2 Force reorg clearing (Medium) ❌
- Idea3 Storage corruption resets counter (Medium) ❌
- Idea4 Pause/resume trick (Low) ❌
- Idea5 Double clear via reentrancy (Low) ❌

### no-empty-payload-hash
File: `packages/layerzero-v2/evm/protocol/contracts/EndpointV2.sol:343` – empty payload hash must be rejected.
- Idea1 Send bytes32(0) to bypass checks (High) ✅
- Idea2 Malformed packet zeroes hash (Medium) ❌
- Idea3 Re-encode with 0-length data (Low) ❌
- Idea4 Underflow to zero hash (Low) ❌
- Idea5 Dummy zero-hash message (Low) ❌

### composer-assert-sender
File: `packages/layerzero-v2/evm/protocol/contracts/MessagingComposer.sol:17` – composer must verify the caller of compose messages.
- Idea1 Attacker sends compose and executes (High) ✅
- Idea2 Replay old compose after deletion (Medium) ❌
- Idea3 Cross-chain spoof via compromised executor (Low) ❌

### precrime-simulator-revert
File: `packages/layerzero-v2/evm/oapp/contracts/precrime/OAppPreCrimeSimulator.sol:41` – simulator must revert to surface results.
- Idea1 Omit revert allowing ignore (High) ✅
- Idea2 Revert with wrong selector (Medium) ❌
- Idea3 Non-EOA call bypass (Low) ❌

